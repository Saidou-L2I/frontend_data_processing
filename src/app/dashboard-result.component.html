<div class="row g-4" *ngIf="processingResult">
  <div class="col-12">
    <div class="card border-0 shadow-sm bg-success text-white">
      <div class="card-body d-flex align-items-center p-4">
        <i class="fas fa-check-circle fa-3x me-3"></i>
        <div>
          <h2 class="mb-0">Traitement Terminé</h2>
          <p class="mb-0 opacity-75">Fichier : <strong>{{ selectedFile?.name }}</strong> | {{ processingResult.records_processed }} lignes analysées.</p>
        </div>
      </div>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card border-0 shadow-sm text-center p-3 h-100">
      <small class="text-muted fw-bold text-uppercase">Lignes Finales</small>
      <h3 class="text-primary mt-2 mb-0">{{ processingResult.final_analysis.shape[0] }}</h3>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card border-0 shadow-sm text-center p-3 h-100">
      <small class="text-muted fw-bold text-uppercase">Colonnes</small>
      <h3 class="text-primary mt-2 mb-0">{{ processingResult.final_analysis.shape[1] }}</h3>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card border-0 shadow-sm text-center p-3 h-100">
      <small class="text-muted fw-bold text-uppercase">Valeurs Nulles</small>
      <h3 [ngClass]="(processingResult.final_analysis.missing_total === 0) ? 'text-success' : 'text-danger'" class="mt-2 mb-0">
        {{ processingResult.final_analysis.missing_total }}
      </h3>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card border-0 shadow-sm text-center p-3 h-100">
      <small class="text-muted fw-bold text-uppercase">Doublons</small>
      <h3 class="text-primary mt-2 mb-0">{{ processingResult.final_analysis.duplicates }}</h3>
    </div>
  </div>

  <div class="col-lg-8">
    <div class="card border-0 shadow-sm h-100">
      <div class="card-header bg-white py-3 border-0">
        <h5 class="mb-0"><i class="fas fa-chart-line me-2 text-primary"></i>Comparaison des données</h5>
      </div>
      <div class="table-responsive p-3">
        <table class="table table-hover align-middle">
          <thead class="table-light">
            <tr>
              <th>Indicateur</th>
              <th class="text-center">Original</th>
              <th class="text-center">Traité</th>
              <th class="text-center">État</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Nombre de lignes</td>
              <td class="text-center text-muted">{{ processingResult.original_analysis.shape[0] }}</td>
              <td class="text-center fw-bold">{{ processingResult.final_analysis.shape[0] }}</td>
              <td class="text-center">
                <span class="badge bg-light text-dark border">
                  {{ processingResult.final_analysis.shape[0] - processingResult.original_analysis.shape[0] }}
                </span>
              </td>
            </tr>
            <tr>
              <td>Valeurs manquantes</td>
              <td class="text-center text-muted">{{ processingResult.original_analysis.missing_total }}</td>
              <td class="text-center fw-bold">{{ processingResult.final_analysis.missing_total }}</td>
              <td class="text-center text-success"><i class="fas fa-check-double"></i></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <div class="col-lg-4">
    <div class="card border-0 shadow-sm mb-4">
      <div class="card-header bg-white py-3 border-0">
        <h5 class="mb-0"><i class="fas fa-cog me-2 text-primary"></i>Configuration appliquée</h5>
      </div>
      <ul class="list-group list-group-flush">
        <li class="list-group-item d-flex justify-content-between align-items-center px-4">
          Manquants <span class="badge rounded-pill bg-info text-dark">{{ options.handle_missing }}</span>
        </li>
        <li class="list-group-item d-flex justify-content-between align-items-center px-4">
          Doublons <span class="badge rounded-pill bg-info text-dark">{{ options.handle_duplicates }}</span>
        </li>
        <li class="list-group-item d-flex justify-content-between align-items-center px-4">
          Normalisation 
          <span [class]="options.normalize ? 'text-success' : 'text-muted'">
            {{ options.normalize ? 'Activée' : 'Non' }}
          </span>
        </li>
      </ul>
    </div>

    <div class="d-grid gap-2">
      <button class="btn btn-success btn-lg shadow-sm" (click)="downloadProcessedFile()">
        <i class="fas fa-file-download me-2"></i>Télécharger le résultat
      </button>
      <button class="btn btn-outline-secondary" (click)="reset()">
        <i class="fas fa-redo me-2"></i>Traiter un autre fichier
      </button>
    </div>
  </div>
</div>