<nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow-sm sticky-top">
  <div class="container">
    <a class="navbar-brand fw-bold" href="javascript:void(0)" (click)="reset()">
      <i class="fas fa-robot me-2"></i>DSIA DataCleaner
    </a>
    <div class="navbar-nav ms-auto">
      <a class="nav-link px-3"
         href="javascript:void(0)"
         (click)="reset()"
         [class.active]="!processingResult">
        <i class="fas fa-cog me-1"></i> Configuration
      </a>
      <a class="nav-link px-3"
         href="javascript:void(0)"
         *ngIf="processingResult"
         class="active">
        <i class="fas fa-chart-pie me-1"></i> Dashboard
      </a>
    </div>
  </div>
</nav>

<main class="container mt-5 mb-5">

  <!-- DASHBOARD -->
  <div class="row g-4" *ngIf="processingResult">

    <!-- SUCCESS MESSAGE -->
    <div class="col-12">
      <div class="alert alert-success border-0 shadow-sm d-flex align-items-center p-4">
        <i class="fas fa-check-circle fa-3x me-3"></i>
        <div>
          <h3 class="alert-heading mb-1">Nettoyage terminé avec succès !</h3>
          <span>Fichier prêt : <strong>{{ selectedFile?.name }}</strong></span>
        </div>
      </div>
    </div>

    <!-- LIGNES -->
    <div class="col-md-3">
      <div class="card border-0 shadow-sm text-center p-3 h-100">
        <small class="text-muted fw-bold text-uppercase">Lignes Finales</small>
        <h2 class="text-primary fw-bold mt-2 mb-0">
          {{ processingResult.final_analysis.shape[0] }}
        </h2>
        <small class="text-muted">
          sur {{ processingResult.original_analysis.shape[0] }}
        </small>
      </div>
    </div>

    <!-- COLONNES -->
    <div class="col-md-3">
      <div class="card border-0 shadow-sm text-center p-3 h-100">
        <small class="text-muted fw-bold text-uppercase">Colonnes Finales</small>
        <h2 class="text-info fw-bold mt-2 mb-0">
          {{ processingResult.final_analysis.shape[1] }}
        </h2>
        <small class="text-muted">
          sur {{ processingResult.original_analysis.shape[1] }}
        </small>
      </div>
    </div>

    <!-- DOUBLONS -->
    <div class="col-md-3">
      <div class="card border-0 shadow-sm text-center p-3 h-100">
        <small class="text-muted fw-bold text-uppercase">Doublons Supprimés</small>
        <h2 class="text-danger fw-bold mt-2 mb-0">
          {{ processingResult.original_analysis.duplicates - processingResult.final_analysis.duplicates }}
        </h2>
        <small class="text-muted">Détectés automatiquement</small>
      </div>
    </div>

    <!-- OUTLIERS -->
    <div class="col-md-3">
      <div class="card border-0 shadow-sm text-center p-3 h-100">
        <small class="text-muted fw-bold text-uppercase">Valeurs Aberrantes</small>
        <h2 class="text-warning fw-bold mt-2 mb-0">
          {{ processingResult.original_analysis.outliers_total }}
        </h2>
      </div>
    </div>

    <!-- TABLE IMPACT -->
    <div class="col-lg-8">
      <div class="card border-0 shadow-sm">
        <div class="card-header bg-white py-3">
          <h5 class="mb-0 fw-bold">
            <i class="fas fa-balance-scale me-2 text-primary"></i>
            Impact du nettoyage
          </h5>
        </div>
        <div class="card-body p-0">
          <div class="table-responsive">
            <table class="table table-hover align-middle mb-0">
              <thead class="table-light">
                <tr>
                  <th class="ps-4">Métrique</th>
                  <th class="text-center">Avant</th>
                  <th class="text-center">Après</th>
                  <th class="text-center">Statut</th>
                </tr>
              </thead>
              <tbody>

                <!-- LIGNES -->
                <tr>
                  <td class="ps-4 fw-medium">Volume de données (Lignes)</td>
                  <td class="text-center text-muted">
                    {{ processingResult.original_analysis.shape[0] }}
                  </td>
                  <td class="text-center fw-bold">
                    {{ processingResult.final_analysis.shape[0] }}
                  </td>
                  <td class="text-center">
                    <span class="text-danger small"
                          *ngIf="processingResult.final_analysis.shape[0] < processingResult.original_analysis.shape[0]">
                      <i class="fas fa-arrow-down me-1"></i>
                      {{ processingResult.original_analysis.shape[0] - processingResult.final_analysis.shape[0] }} supprimées
                    </span>
                  </td>
                </tr>

                <!-- COLONNES -->
                <tr>
                  <td class="ps-4 fw-medium">Nombre de Colonnes</td>
                  <td class="text-center text-muted">
                    {{ processingResult.original_analysis.shape[1] }}
                  </td>
                  <td class="text-center fw-bold">
                    {{ processingResult.final_analysis.shape[1] }}
                  </td>
                  <td class="text-center">
                    <i class="fas fa-columns text-info"></i>
                  </td>
                </tr>

                <!-- VALEURS MANQUANTES -->
                <tr>
                  <td class="ps-4 fw-medium">Valeurs Manquantes (Cellules)</td>
                  <td class="text-center text-muted">
                    {{ processingResult.original_analysis.missing_total }}
                  </td>
                  <td class="text-center text-success fw-bold">
                    {{ processingResult.final_analysis.missing_total }}
                  </td>
                  <td class="text-center">
                    <span class="badge bg-success">Complété</span>
                  </td>
                </tr>

                <!-- DOUBLONS -->
                <tr>
                  <td class="ps-4 fw-medium">Doublons Identifiés</td>
                  <td class="text-center text-muted">
                    {{ processingResult.original_analysis.duplicates }}
                  </td>
                  <td class="text-center text-success fw-bold">
                    {{ processingResult.final_analysis.duplicates }}
                  </td>
                  <td class="text-center">
                    <i class="fas fa-check-double text-success"></i>
                  </td>
                </tr>

              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

  </div>
</main>
